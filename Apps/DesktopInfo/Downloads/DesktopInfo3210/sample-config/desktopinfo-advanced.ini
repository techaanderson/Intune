# Desktop Info by Glenn Delahoy
# Sample advanced configuration file
# See the manual for a full description of all options

# desktop options
[options]

# size and position
top=0
right=5
width=450
font-size=10
font-face=Arial

# logging
log=%APPDATA%\DesktopInfo\desktopinfo.log
log-level=debugonerror

# window mode options
[options-w]
top=70
width=900
height=800
font-size=10
font-face=Arial
formcolor=501020
display-offsetx=5
display-offsetxr=5

# logging
log=%appdata%\DesktopInfo\desktopinfo.log
log-level=debugonerror

# screen saver options
[screen-saver]
font-size=20
width=1000
formcolor=501020

[text]
noresults=<n/a>
error=[error]
null-result=<null>
unknown=Unknown
executing=<executing>
true=true,yes,good
false=false,no,bad
menu-export=Export
menu-snapshot=Snapshot
menu-ini=Select Config
menu-reload=Reload
menu-configuration=Edit Configuration
menu-log=Open Log File
menu-manual=Read Manual
menu-wmode=Start W Mode
menu-about=About Desktop Info
menu-quit=Quit
nav-previous=Previous
nav-home=Home
nav-next=Next

[items]

# everything in this block is evaluated immediately after load and never again
BEGIN-ONLOAD

# battery status lookup table
set battery1      = Disconnected
set battery2      = Connected
set battery3      = Fully Charged
set battery<null> = Not In Use

# application banner
COMMENT=global:0, align:c,color:%white%,font-size:14,id:title,rich-text:1,text:\fdti\a\fVerdana\ Desktop Info \i\by Glenn Delahoy

# if the IF evaluates to TRUE then items are global else are discarded
# top toolbar for window mode
BEGIN-GLOBAL=global:0, value1:%dtimode%, comp:eq,  value2:WINDOW
 BUTTON= wide:1,  left:-5, width:85, display:Prev,uri:{page}, args:previous, hint:previous page
 BUTTON2= wide:1, left:81,        width:85, display:Home,uri:{page}, args:home,hint:home page
 BUTTON2= wide:1, left:167,        width:85, display:Next,uri:{page}, args:next,hint:next page
 BUTTON2= wide:1, left:253,        width:85, display:Tools,uri:{page}, args:24,hint:tools
END-GLOBAL

# lower navigation buttons for desktop mode
BEGIN-GLOBAL=global:-1, value1:%dtimode%, comp:eq, value2:DESKTOP
NAV= align:c, font-size:18
END-GLOBAL

# try these alternative nav buttons
#NAV=global:-1,font-face:wingdings,caption-prev:ç,caption-home:n,caption-next:è,font-size:20
#NAV=global:-1,font-face:wingdings,caption-prev:×,caption-home:n,caption-next:Ø,font-size:20
#NAV=global:-1,font-face:webdings,caption-prev:7,caption-home:<,caption-next:8

END-ONLOAD

GROUP=id:summary, background-interval:10, items:local_time cpu topprocesscpu physicalram topprocessmem networkperf

#
#
#

# date/time
PAGE=1
PAGE-TITLE=Home Page
COLOR=%cyan%

DATETIME=interval:5,background-interval:5,display:%11 %10,id:local_time, if-value1:1, if-comp:eq, if-value2:2
WMI=interval:60,hide-no-result:1,id:battery,text:Battery,\
  alarms:(%15 le 20 %red%) (%15 le 40 %orange%),namespace:root\cimv2,query:Win32_Battery,display:%EstimatedChargeRemaining%% (%battery%BatteryStatus%%)

# cpu
CORETEMP=interval:10,background-interval:10,display:%1%2, set:coretemp, hidden:1
CPU=background-interval:10,\
  alarms:(%1 ge 80 %red%)(%2 ge 60 %red%)(%3 ge 30 %orange%),\
  display:Tot: %1[2.0f]%\, Krnl: %2[2.0f]%\, Queue: %3\, %coretemp%
CHART=source-id:cpu, chart:filled max:100 border-color:%grey% series1:1 color1:00ff00 series2:2 color2:bb00bb series3:%3 color3:%red%

# following is an alternative cpu measurement using the WMI performance counters - this might be more accurate on newer machines
# WMI=interval:1,id:cputotal,text:Cpu,\
#   namespace:root\cimv2,query:Win32_PerfFormattedData_Counters_ProcessorInformation where Name like "_Total",\
#   chart:line2 scale:linear max:100 series1:%PercentProcessorUtility% color1:00ff00,threshold:80 0000ff, \
#   display:Total: %PercentProcessorUtility%%

TOPPROCESSCPU=interval:3,font-size:80%,text:Top Cpu,display:%1 (pid:%2) %3[1.1f]%

# memory
COMMENT=font-size:50%
COLOR=b0ffb0
PHYSICALRAM=interval:30,font-size:120%,alarms:(%3 ge 80 %red%),display:%1[3.1b]B / %2[3.1b]B (%3% used)
TOPPROCESSMEM=interval:10,font-size:80%,text:Top Memory,display:%1 (pid:%2) %3[1.1b]B
PAGEFAULTS=font-size:100%,alarms:(%5 le 80 2222c0),display:Tot: %1[1.0f]\, Hrd: %2[1.0f]\, Hit: %5[1.0f]%

# network
COMMENT=font-size:50%
COLOR=%Cyan%

NETWORKPERF=interval:2,background-interval:2, row-text:%instance%, log-counters:1, local:0, hide-no-result:1, \
  chart:line scale:log row-id:%instance% border-color:%grey% series1:%BytesReceivedPersec% color1:00ff00 series2:%BytesSentPersec% height:2 color2:bb00bb,\
  alarms:(%BytesReceivedPersec% ge {{%CurrentBandwidth%/8*95/100}} 2222ee)(%BytesSentPersec% ge {{%CurrentBandwidth%/8*95/100}} 0000ff),\
  display:R: %BytesReceivedPersec%[3.1b]Bps\, S: %BytesSentPersec%[3.1b]Bps\, B: %CurrentBandwidth%[1.0B]bps

# disks
COMMENT=font-size:50%
COLOR=%Silver%

# uses PDH for diskio values. set usewmi:1 to use wmi instead
LOGICALDRIVES=diskio:1,font-size:85%,chart:bar max:100 series1:7 threshold:75, text-align:l,\
  alarms:(%11 ge 10000000 0000f0)(%13 ge 10000000 0000f0)(%7 ge 90 0070f0),\
  row-text:Drive %1: (%2) %3|%chart%,\
  display:%6[1.0B]B/%5[1.0B]B (%7[1.1f]% used)|  r: %11[1.1B]B/s\, w: %13[1.1B]B/s\, q: %17\, i: %19[1.1f]%

# windows
PAGE=2
PAGE-TITLE=Windows
MENU=Windows
COLOR=%Cyan%

COMMENT=color:%White%,style:m,rich-text:1, font-size:11, text:\fdti\b\fArial\\i\\b\ Dates / Times
DATETIME=interval:10,display:%9 %10
TIMEZONE=interval:3600,display:%1 (%2)
WMI=interval:3600,text:Daylight Savings,namespace:root\cimv2,query:CIM_ComputerSystem,display:Enabled: %EnableDaylightSavingsTime%[b:Yes:No]\, In Effect: %DaylightInEffect%[b:Yes:No]
BOOTTIME=display:%9 %10
UPTIME=interval:60,display:%1 days %2 hrs %3 mins
COMMENT

COLOR=%White%

# windows configuration
COMMENT=color:%White%,style:m,rich-text:1, font-size:11, text:\fdti\c\fArial\\i\\b\ Windows Configuration
OSBUILD2=background-interval:3600,display:%1{{{ (%2)}}}|Build: %3{{{ (%18)}}}|Installed: %install_date_short% %install_time_short%\
 |Win Dir: %windowsdirectory%|Sys Dir: %systemdirectory%
SERVICEPACK=hide-no-result:1

USER=set:username,hidden:1,background-interval:3600
HOST=text:Host/User,display:%1/%username%,background-interval:3600
REG=interval:600,text:Firewall,value:HKLM\SYSTEM\CurrentControlSet\services\SharedAccess\Parameters\FirewallPolicy\DomainProfile\EnableFirewall,display:%1[b:Active:Not Active]
REG=interval:600,hide-no-result:1,text:Auto Update,value:HKLM\Software\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update\Results\Install\LastSuccessTime,display:%1
REG=interval:600,text:UAC Enabled,value:HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\EnableLUA,display:%1[b:Enabled:Disabled]
#Secureboot/UEFI status
REG=interval:600,hide-no-result:1,text:Secure Boot Status,value:HKLM\SYSTEM\CurrentControlSet\Control\SecureBoot\State\UEFISecureBootEnabled,display:%1[b:Enabled:Disabled]
REG2=interval:60, text:Anti-Virus, key:HKLM\SOFTWARE\Microsoft\Security Center\Provider\Av, subkeys:1,\
  values:DISPLAYNAME\,STATE, display:%DISPLAYNAME%|  %STATE%[bit:4096:Enabled:Disabled] and %STATE%[bit:393216:up to date:not up to date]
IEVERSION
DIRECTX
VIRTUALDESKTOP=hide-no-result:1

SET-SECTION=key:pending-reboot,value:pending-reboot.ps1
CMD=interval:3600,text:Reboot Pending,trim:1,file:powershell.exe,parameters:%pending-reboot%,code-page:437,thread:1

SET-SECTION=key:windows-updates,value:windows-updates.ps1
CMD=interval:3600,text:Pending Updates,trim:1,file:powershell.exe,parameters:%windows-updates%,code-page:437,thread:1
comment

COMMENT=color:%White%,text:BitLocker Status,style:imb
SET-SECTION=key:bitlocker-status,value:bitlocker-status.ps1
set bitlocker-query=Local Fixed
CMD=interval:3600,text:Bitlocker Status,trim:1,file:powershell.exe,parameters:%bitlocker-status%,code-page:437,wide:1,font-face:Consolas
comment

BEGIN-ONLOAD
IF %dtimode% eq DESKTOP
BUTTON=align:r, color:%orange%, display:Windows Updates,uri:explorer,args:ms-settings:windowsupdate,hint:Windows updates
IF %dtimode% eq WINDOW
BUTTON=xr:0, y:0, align:r, color:%white%, display:Windows Updates,uri:explorer,args:ms-settings:windowsupdate,hint:Windows updates
COMMENT=font-size:50%
END-ONLOAD

# network
PAGE=3
PAGE-TITLE=Network
MENU=Network
FONT-FACE=Arial
COLOR=%cyan%
WIDE=0

COMMENT=color:%White%,style:m,rich-text:1, font-size:11, text:\fdti\d\fArial\\i\\b\ Network

HOST
USER
DOMAIN=no-result:Workgroup
DOMAINCONTROLLER=hide-no-result:1
DNSSERVER
WMI=interval:600,hide-no-result:1,text:Workgroup,namespace:root\cimv2,query:Win32_ComputerSystem, display:%Workgroup%
NETCONNECTIONS=interval:5
NETPACKETS=interval:5,display:r:%1[1.0n]  s:%2[1.0n]
NETPACKETSRATE=interval:5,text:Net Rate,mtu:1500,display:r:%1[1.1b]Bps  s:%2[1.1b]Bps
WMI=interval:60,background-interval:60,id:latency,font-size:120%, set:resp4=%ResponseTime%, \
  chart: type:line series1:%ResponseTime%,\
  alarms:(%11 ge 100 0088f0),text:Network Latency, \
  namespace:root\cimv2,query:Win32_PingStatus where address='google.com',\
  display:%ResponseTime%ms (google.com) %chart%
WMI=interval:60,background-interval:60,id:latencyipv6,font-size:120%, set:resp6=%ResponseTime%, \
  chart: type:line series1:%ResponseTime%,\
  alarms:(%11 ge 100 0088f0),text:Network Latency IPv6, \
  namespace:root\cimv2,query:Win32_PingStatus where address='ipv6.google.com',\
  display:%ResponseTime%ms (google.com) %chart%

COLOR=%silver%
NETWORKINTERFACES=interval:30,font-size:85%,operstatus:1,iftype:6 23 71 243,ipv4list: %8/%10|,ipv6list:  %11|, row-text:%2|%4|link: t:%23[1.0B]Bps\, r:%24[1.0B]Bps,display:%8/%10 (%14)| gw:%17| dns:%15| dhcp:%19|  %25 {{{|  ipv6:%26}}}
SET-SECTION=key:wifi-status,value:wifi-status.ps1
CMD=interval:120,color:55cc77,text:WiFi Status,wide:1,thread:2,read-as-csv:1,csv-header:1,file:powershell.exe, \
  parameters:-Command %wifi-status%,trim:1,show-window:0,hide-no-result:1, \
  display:SSID: %SSID%   Encryption: %Auth% / %Cipher%|   BaseStation ID: %BSSID%   Type: %NetType%|   Radio: %Radio%   Band: %Band%   Channel: %Channel%   Signal: %Signal%
COLOR=%orange%

CHART=interval:2, source-id:networkperf, row-text:%instance%, chart:line scale:log row-id:%instance% series1:%BytesReceivedPersec% color1:00ff00 series2:%BytesSentPersec% height:2 color2:bb00bb,\
  display:R: %BytesReceivedPersec%[3.1b]Bps\, S: %BytesSentPersec%[3.1b]Bps\, B: %CurrentBandwidth%[1.0B]bps

HTTPGET=interval:600,text:External ipv4,source:http://ipecho.net/plain
#HTTPGET=interval:3600,text:External ipv6,source:http://[ipv6.plain-text-ip.com],font-size:85%

COLOR=%silver%
COMMENT=color:%White%,style:imb,text:Remote Desktop
RDS=interval:20,font-size:80%,row-text:Console Session ID|Current Session|Address,display:%2|sid:%3 %7\%6|%8
COMMENT=color:%White%,style:imb,text:Remote Desktop Sessions
RDSSESSIONS=interval:20,font-size:80%,row-text:%1,display:sid:%2 state:%3[e:Active:Connected:ConnectQuery:Shadow:Disconnected:Idle:Listen:Reset:Down:Init]

BEGIN-ONLOAD
IF %dtimode% eq DESKTOP
BUTTON=wide:1,align:r,color:%orange%,text:,display:Network Connections,uri:%SystemRoot%\System32\control.exe,args:ncpa.cpl,hint:Network connections
IF %dtimode% eq WINDOW
BUTTON=xr:0, y:0, align:r, color:%white%, text:,display:Network Connections,uri:%SystemRoot%\System32\control.exe,args:ncpa.cpl,hint:Network connections
END-ONLOAD

# hardware
PAGE=4
PAGE-TITLE=Hardware
MENU=Hardware
COLOR=%Cyan%

COMMENT=color:%White%,style:m,rich-text:1, font-size:11, text:\fdti\e\fArial\\i\\b\ Hardware
WMI=interval:60,hide-no-result:1,text:Battery,namespace:root\cimv2,query:Win32_Battery,display:%EstimatedChargeRemaining%% (%battery%BatteryStatus%%)
OEMINFO=display:%2,hide-no-result:1
WMI=text:Trusted Platform Module,namespace:root\cimv2\Security\MicrosoftTpm,query:Win32_Tpm,\
 display:Active:%IsActivated_InitialValue%[b:Yes:No]\, Enabled:%IsEnabled_InitialValue%[b:Yes:No]\, Owned:%IsOwned_InitialValue%[b:Yes:No]\
 |Version: %SpecVersion%\, Manuf Vers: %ManufacturerVersion%\
 |Info: %ManufacturerVersionInfo%\
 |Manuf Id: %ManufacturerId%\
 |Phys Version: %PhysicalPresenceVersionInfo%
WMI=text:Audio Controller,namespace:root\cimv2,query:Win32_SoundDevice,display:%Caption%

# motherboard
COMMENT=color:%White%,style:imb,text:Motherboard
WMI=text:Bios,namespace:root\cimv2,query:Win32_Bios,display:%Caption%|Ser: %SerialNumber%, set:biosserial=%SerialNumber%, hidden:1
WMI=interval:10,id:temp,hide-no-result:1,maxrows:1,text:Cpu Temp, set:mbtemp={{%CurrentTemperature%/10-273.15}}[1.0f]C,\
  namespace:root\wmi,query:MSAcpi_ThermalZoneTemperature, hidden:1
WMI=namespace:root\wmi, query:MS_SystemInformation, \
  row-text:Manufacturer|BIOS Vendor|BIOS Version|BIOS Serial|System Family, \
  display:%BaseboardManufacturer% %BaseboardProduct% (%mbtemp%)|%BIOSVendor%|%BIOSVersion% (%BIOSReleaseDate%)|%BIOSSerial%|%SystemFamily%

# display hardware
comment=style:m,color:%white%, rich-text:1, font-size:11, text:\fdti\a\fArial\\i\\b\ Display Hardware
# get the windows major version
OSBUILD=set:winmajor=%2,hidden:1
# vista or later
IF=value1:%winmajor%, comp:ge, value2:6
WMI=namespace:root\cimv2,query:Win32_VideoController,\
  text:Display Adapters, display:%caption% (%CurrentHorizontalResolution%x%CurrentVerticalResolution%x%CurrentBitsPerPixel%)
# earlier than vista
IF=value1:%winmajor%,value2:6,comparator:lt
WMI=namespace:root\cimv2,query:Win32_DisplayControllerConfiguration,\
  text:Display Adapters, display:    %caption%   (%HorizontalResolution%x%VerticalResolution%x%BitsPerPixel%)

comment=text:Monitors,color:%white%
comment=display:  Ndx  Wdth  Hght  Left   Top   Ppi Pri Desc, font-face:Consolas
MONITORS=interval:10,wide:1, font-face:consolas, display:%curr%[b:*: ] %num%[3.0f] %width%[5.0f] %height%[5.0f] %left%[5.0f] %top%[5.0f] %ppi%[5.0f] %primary%[b:Pri:   ] %desc%

BUTTON=hyperlink:1,  wide:1,   color:%orange%, display:Devices and Printers,uri:control,args:printers
BUTTON2=hyperlink:1, left:140, color:%orange%, display:Device Manager,uri:devmgmt.msc
COMMENT=font-size:50%

COMMENT=color:%White%,style:imb,text:Serial Ports
WMI=interval:10,font-size:80%,id:PnPPorts,text:PnP Ports,namespace:root\cimv2,query:Win32_PnPEntity where name like "%(COM%",display:%caption%,set:deviceid
WMI=interval:10,font-size:80%,id:SerialPorts,text:Serial Ports,namespace:root\wmi,query:MSSerial_PortName,display:%PortName%\, %InstanceName%
COMMENT=font-size:50%

# cpu
PAGE=5
PAGE-TITLE=Cpu
MENU=Hardware
WIDE=0

COMMENT=color:%White%,style:m, rich-text:1, font-size:11, text:\fdti\e\fArial\\i\\b\ CPU
CPUTYPE=font-size:80%, maxrows:1, row-text:Processor|Vendor|Identifier|Speed, \
   display:%ProcessorNameString%|%VendorIdentifier%|%Identifier%|%~MHz%[2.2K]GHz
CPUCOUNT=font-size:80%,display:%1
WMI=interval:5,font-size:80%, row-text:Max Clock Speed|Current Clock Speed,namespace:root\cimv2,query:Win32_Processor,\
  display:%MaxClockSpeed%MHz|%CurrentClockSpeed%MHz
WMI=interval:5,hide-no-result:1,text:M/B Temp Sensors,namespace:root\wmi,query:MSAcpi_ThermalZoneTemperature,\
  display: {{%CurrentTemperature%/10-273.15}}[1.1f]°C

WIDE=1
CPU=background-interval:10,wide:1, chart:filled max:100 border:0 series1:1 color1:00ff00 series2:2 color2:0000bb,\
  alarms:(%1 ge 80 0000ff)(%2 ge 40 0000ff),\
  display:Total: %1[2.0f]%\, Kernel: %2[2.0f]%\, Queue: %3\, %coretemp%| \
  Processes: %Processes%\, Threads: %Threads%|\
  Sys Calls/sec: %SystemCallsPersec%[2.0f]\, Con Switches/sec: %ContextSwitchesPersec%[2.0f]\, Exc Disps/sec: %ExceptionDispatchesPersec%[2.0f]

CPUUSAGE=wide:1, font-face:Consolas, font-size:8, rich-text:1, align:c,\
  chart:bar max:100 border-color:%grey%  series1:%PercentProcessorTime% color1:c00000 threshold:80 width:230,\
  display:Core %1: \c%white%\%2[3.0f]% %chart%

COMMENT
COMMENT=color:%White%,style:u,text:Top Processes,align:c
TOPPROCESSCPU=interval:3, background-interval:3, wide:1,align:c,font-face:Consolas,maxrows:10,\
  alarms:(%3 gt 80 %red%), \
  chart:filled series1:%cpu% color1:%orange% width:100 row-id:%process% max:100, \
  display:%1[0.25s]%2[10.0f]%3[4.1f]%  %chart%
COMMENT

BEGIN-ONLOAD
IF %dtimode% eq DESKTOP
BUTTON=align:r, color:%orange%,text:,display:Performance Monitor,uri:perfmon
IF %dtimode% eq WINDOW
BUTTON=xr:0, y:0, align:r, color:%white%, text:,display:Performance Monitor,uri:perfmon
END-ONLOAD

# physical drives
PAGE=6
PAGE-TITLE=Physical Drives
MENU=Hardware
WIDE=0

COMMENT=color:%White%,style:m, rich-text:1, font-size:11, text:\fdti\f\fArial\\i\\b\ Physical Drives
PHYSICALDRIVES=interval:60,regex:^[ \t]+|[ \t]+$,\
  row-text:%1|Status: %15|Size: %14[1.0B]B|%12,\
  alarms:(%smart_reallocated_sectors% ge 10 %orange%) (%smart_reallocated_sectors% ge 50 %red%),\
  display:%3|id: %5|Media: %9|Model: %10|Serial: %13\, Attribs: %smart_primary%[b:Primary: ] %smart_master%[b:Master: ]\
  |SMART Version:%smart_version%.%smart_revision%\, Device Type:%smart_device_type%\,\
  |  Supports:%smart_ata%[b:ATA : ]%smart_atapi%[b:ATAPI : ]%smart_smart%[b:SMART:]\
  |  Temp: %smart_temp%°C\, Reallocated: %smart_reallocated_sectors% sectors{{{\, %smart_reallocated_events% events}}}\
  |  Power On Count: %smart_poweron_count%\, Hours: %smart_poweron_hours%\
  {{{|  G-Sense Error Rate: %smart_gsense_error%}}}||

COMMENT=color:%White%,style:m, rich-text:1, font-size:11, text:\fdti\g\fArial\\i\\b\ Logical Drives
LOGICALDRIVES=diskio:1,font-size:85%,chart:bar max:100 series1:7 threshold:75, text-align:l,\
  alarms:(%11 ge 10000000 0000f0)(%13 ge 10000000 0000f0)(%7 ge 90 0070f0),\
  row-text:Drive %1: (%2) %3|%chart%,\
  display:%6[1.0B]B/%5[1.0B]B (%7[1.1f]% used)|r: %11[1.1B]B/s\, w: %13[1.1B]B/s\, q: %17\, i: %19[1.1f]%\
    |avg sec/read: %15[1.3f]\,  avg sec/wri: %16[1.3f]

BEGIN-ONLOAD
IF %dtimode% eq DESKTOP
BUTTON=align:r, color:%orange%, display:Disk Management, uri:diskmgmt.msc
IF %dtimode% eq WINDOW
BUTTON=xr:0, y:0, align:r, display:Disk Management, uri:diskmgmt.msc
END-ONLOAD

# memory
PAGE=7
PAGE-TITLE=Memory
MENU=Hardware
COLOR=%Cyan%

COMMENT=color:%White%,style:m, rich-text:1, font-size:11, text:\fdti\e\fArial\\i\\b\ Physical RAM
# %MemoryType% is enumerated type
WMI=namespace:root\cimv2,query:Win32_PhysicalMemory,row-text:%BankLabel%,display:%Capacity%[1.0b]B %DeviceLocator% \
  %MemoryType%[e:Unknown:Other:DRAM:Sync DRAM:Cache DRAM:EDO:EDRAM:VRAM:SRAM:RAM:ROM:Flash:EEPROM:FEPROM:EPROM:CDRAM:3DRAM:SDRAM:SGRAM:RDRAM:DDR:DDR2:DDR2 FB-DIMM:Unknown:DDR3:FBD2:DDR4]\
  |%Manufacturer%
COMMENT
MEMORY=interval:5,display:Phys: %physusedbytes%[3.1b]B / %phystotalbytes%[3.1b]B (%physusedpct%% used)\
 |Virt: %virtusedbytes%[3.1b]B / %virttotalbytes%[3.1b]B (%virtusedpct%% used)\
 |Page: %pageusedbytes%[3.1b]B / %pagetotalbytes%[3.1b]B (%pageusedpct%% used)
PAGEFILE=interval:5, display:%used%[1.1b]B / %total%[1.1b]B (%usedpct%%)
TOPPROCESSPF=interval:5,maxrows:5,font-size:80%,text:Top Processes PF,display:%1 (pid:%2) %3[1.2B] faults
comment
COMMENT=color:%White%,style:imb,text:Performance
PERF=path:\Memory\*, local:0, color:%lightgrey%, \
  alarms:({{(%PageFaultsPersec%-%PagesPersec%)/%PageFaultsPersec%*100}} le 80 2222c0),\
  chart:pie height:6 border:1 float:1 series1:{{(%PageFaultsPersec%-%PagesPersec%)/%PageFaultsPersec%*100}} series2:{{100-((%PageFaultsPersec%-%PagesPersec%)/%PageFaultsPersec%*100)}} color2:#000000,\
  text:%chart%,\
  display:Page Faults/sec: %PageFaultsPersec%[1.0f]|Hard Faults/sec: %PagesPersec%[1.0f]\
  |Hit Rate: {{(%PageFaultsPersec% - %PagesPersec%) / %PageFaultsPersec% * 100}}[1.1f]%\
  |Available: %AvailableBytes%[1.1B]B|Committed: %CommittedBytes%[1.1B]B\
  |Committed In Use: %PercentCommittedBytesInUse%[1.1f]%||

COMMENT=color:%White%,style:imb,text:Top Processes
TOPPROCESSMEM=interval:3,wide:1,align:c,font-face:Consolas,maxrows:10,counter:pu,\
  chart:line series1:%3 width:100 row-id:%1,\
  display:%1[0.26s] %2[10.0f] %3[6.1b]B %chart%
COMMENT

BEGIN-ONLOAD
IF %dtimode% eq DESKTOP
BUTTON=wide:1, align:r, color:%orange%, text:,display:Resource Monitor, uri:resmon
IF %dtimode% eq WINDOW
BUTTON=xr:0, y:0, align:r, color:%white%, text:,display:Resource Monitor, uri:resmon
END-ONLOAD

# printers
PAGE=8
PAGE-TITLE=Printers
MENU=Windows
WIDE=1

comment=style:m, color:%white%, rich-text:1, font-size:11, text:\fdti\h\fArial\\i\\b\ Printers
PRINTERS=wide:1, rich-text:1, display:\c%white%\\b\%printer_name%|   \c%silver%\Server:%server_name% %shared%[b: Shared as %share_name%: ] Port:%port_name%\,   Attributes:%queued%[b: Queued:]%direct%[b: Direct:]%default%[b: Default:]%shared%[b: Shared:]%network%[b: Network:]%hidden%[b: Hidden:]%local%[b: Local:]

BEGIN-IF=value1:%dtimode%, comp:eq, value2:DESKTOP
 BUTTON=align:l, color:%orange%, display:Print Management,uri:printmanagement.msc
 BUTTON2=align:r, color:%orange%, display:Devices and Printers,uri:control,args:printers
END-IF
BEGIN-IF=value1:%dtimode%, comp:eq, value2:WINDOW
 BUTTON=xr:132, y:0, align:r, color:%white%, display:Print Management,uri:printmanagement.msc
 BUTTON=xr:0, y:0,   align:r, color:%white%, display:Devices and Printers,uri:control,args:printers
END-IF

# print spool
PAGE=9
PAGE-TITLE=Print Spool
MENU=Windows
WIDE=1

comment=style:m, color:%white%, rich-text:1, font-size:11, text:\fdti\h\fArial\\i\\b\ Printer Spool
DIR=dir:%SystemRoot%\System32\spool\Printers

BEGIN-ONLOAD
BEGIN-IF=value1:%dtimode%, comp:eq, value2:DESKTOP
 BUTTON=align:r, color:%orange%, display:Print Spool,uri:%SystemRoot%\System32\spool\Printers
END-IF
BEGIN-IF=value1:%dtimode%, comp:eq, value2:WINDOW
 BUTTON=xr:0, y:0, align:r, color:%white%, display:Print Spool,uri:%SystemRoot%\System32\spool\Printers
END-IF
END-ONLOAD

# Bios
PAGE=10
PAGE-TITLE=Bios
MENU=Hardware
WIDE=0

COMMENT=color:%White%,style:imb,text:BIOS
REG2=key:HKLM\HARDWARE\DESCRIPTION\System\BIOS, values-to-rows:1, row-text:%1, display:%2

# bluetooth
PAGE=11
PAGE-TITLE=Bluetooth
MENU=Hardware
COLOR=%Silver%
FONT-FACE=Arial
FONT-SIZE=10
WIDE=0

COMMENT=color:%White%,style:m, rich-text:1, font-size:11, text:\fdti\i\fArial\\i\\b\ Bluetooth
# %bluetooth_state% is enumerated type
BLUETOOTH=interval:10, display:State: %bluetooth_state%[e:Disconnected:Connected]|Adapter: %adapter_name%\, Address: %adapter_address%|\
  State: %adapter_state%[e:Off:On:Discovering]\, Num Devices: %num_devices%|Scan Mode: %scan_mode%[e:None:Connectable:Discoverable]
COMMENT=color:%White%,style:m, rich-text:1, font-size:11, text:\fdti\i\fArial\\i\\b\ Bluetooth Devices
BTDEVICES=interval:10, thread:2, service-multirow:1, row-text:%name%|  %ispaired%[b:Paired:Not Paired], display:%address%|State: %state%[e:None:Paired:Connected]\, BT Type: %bluetooth_type%[e:Unknown:Classic:LE:Dual]\, Svcs: %num_services% |%services%

IF %dtimode% eq DESKTOP
BUTTON=align:r, color:%orange%, display:Bluetooth Settings, uri:%windir%\\explorer.exe, args:ms-settings:bluetooth
IF %dtimode% eq WINDOW
BUTTON=xr:0, y:0, align:r, color:%white%, display:Bluetooth Settings, uri:%windir%\\explorer.exe, args:ms-settings:bluetooth

# system power
PAGE=12
PAGE-TITLE=System Power
MENU=Hardware
FONT-FACE=Arial
COLOR=%Silver%
WIDE=0

COMMENT=color:%White%,style:m, rich-text:1, font-size:11, text:\fdti\j\fArial\\i\\b\ System Power
POWER=row-text:AC Status|Battery Present|Charging|Discharging|Max Capacity|Remaining Capacity|Rate|Estimated Time|Default Alert 1|Default Alert 2|Power Scheme, \
  chart:bar series1:%6 max:%5 threshold:{{Neg(%10)}},\
  display:%1[b:Connected:Not Connected]|%2[b:Yes:No]|%3[b:Yes:No]|%4[b:Yes:No]\
  |%5mWh|%6mWh ({{%6/%5*100}}[1.0n]%) %chart%|%7mW|{{%8 / 60}}[1.0n] mins|%9|%10|%11

# windows performance events
PAGE=13
PAGE-TITLE=Performance Events
MENU=Event Logs
FONT-FACE=consolas
COLOR=%silver%
WIDE=1

COMMENT=font-face:Arial,color:%White%,style:m,rich-text:1, font-size:11, text:\fdti\k\fArial\\i\\b\ Windows Boot Performance
COMMENT=color:%white%, text:Boot Start Time          Boot Time   Main Path   Post Boot
EVENTLOGEX=logname:Microsoft-Windows-Diagnostics-Performance/Operational,  maxrows:10, \
  xpath:*[System/EventID=100], namespace:http://schemas.microsoft.com/win/2004/08/events/event, \
  alarms:(%BootTime% gt 90000 %red%) (%BootTime% gt 60000 %orange%), \
  display:%BootStartTime_local%[0.22s]   %BootTime%[9.0n]   %MainPathBootTime%[9.0n]   %BootPostBootTime%[9.0n]

COMMENT=font-face:Arial,color:%White%,style:m, rich-text:1, font-size:11, text:\fdti\k\fArial\\i\\b\ Windows Shutdown Performance
COMMENT=color:%white%, text:Shutdown Start Time      Shutdown End Time         Time(ms)
EVENTLOGEX=logname:Microsoft-Windows-Diagnostics-Performance/Operational, maxrows:10, \
  xpath:*[System/EventID=200], namespace:http://schemas.microsoft.com/win/2004/08/events/event, \
  alarms:(%ShutdownTime% gt 50000 %red%), \
  display:%ShutdownStartTime_local%[0.22s]   %ShutdownEndTime_local%[0.22s]   %ShutdownTime%[9.0n]

# EventID=41 is described as a 'dirty boot' - possible power event
# EventID=1001 bugcheck event
# EventID=6008 unexpected shutdown
COMMENT=font-face:Arial,color:%White%,style:m, rich-text:1, font-size:11, text:\fdti\l\fArial\\i\\b\ Windows Unexpected Shutdown
COMMENT=color:%white%, text:Shutdown Start Time      Shutdown End Time         Time(ms)
EVENTLOGEX=logname:System, maxrows:10, \
  xpath:*[System/EventID=6008], namespace:http://schemas.microsoft.com/win/2004/08/events/event, \
  display:%system_TimeCreated_local%[0.22s]   %ShutdownEndTime_local%[0.22s]   %ShutdownTime%[9.0n]

COMMENT=font-face:Arial,color:%White%,style:m,rich-text:1, font-size:11, text:\fdti\l\fArial\\i\\b\ Windows Compatibility Assistant
COMMENT=color:%white%, text:Created                 Exe Path                                  Resolver Name
EVENTLOGEX=logname:Microsoft-Windows-Application-Experience/Program-Compatibility-Assistant, maxrows:10, \
  xpath:*, namespace:http://www.microsoft.com/Windows/Diagnosis/PCA/events, node:UserData/ResolverFiredEvent, \
  display:%system_TimeCreated_local%[0.22s]  %ExePath%[0.40s]  %ResolverName%[0.30s]

FONT-FACE=Arial
BEGIN-ONLOAD
IF %dtimode% eq DESKTOP
BUTTON=wide:1, align:r, color:%orange%,text:,display:Event Viewer,uri:eventvwr
IF %dtimode% eq WINDOW
BUTTON=xr:0, y:0, align:r, color:%white%, text:,display:Event Viewer,uri:eventvwr
END-ONLOAD

# windows error reporting
PAGE=14
PAGE-TITLE=Windows Error Reporting
MENU=Event Logs
WIDE=1

IF=value1:%dtimode%, comp:eq, value2:DESKTOP, true:10, false:50, set:maxrows=%1

COMMENT=font-face:Arial,color:%White%,style:m, rich-text:1, font-size:11, text:\fdti\l\fArial\\i\\b\ Windows Error Reporting - Event ID 1001
COMMENT=color:%white%, font-face:Consolas, font-size:9, text:Event Time             Details
EVENTLOGEX=interval:60,logname:Application, maxrows:%maxrows%, font-face:Consolas, font-size:9, \
  xpath:*[System/EventID=1001], namespace:http://schemas.microsoft.com/win/2004/08/events/event, \
  display:%system_TimeCreated_local%[0.22s] %17[0.30s] %20[0.30s]

COMMENT
COMMENT=font-face:Arial,color:%White%,style:m, rich-text:1, font-size:11, text:\fdti\l\fArial\\i\\b\ Windows Error Reporting - Event ID 1002 - Application Hang
COMMENT=color:%white%, font-face:Consolas, font-size:9, text:Event Time             Details
EVENTLOGEX=interval:60,logname:Application, maxrows:%maxrows%, font-face:Consolas, font-size:9, \
  xpath:*[System/EventID=1002], namespace:http://schemas.microsoft.com/win/2004/08/events/event, \
  display:%system_TimeCreated_local%[0.22s] %15[0.20s] %20[0.30s]

COMMENT
COMMENT=font-face:Arial,color:%White%,style:m, rich-text:1, font-size:11, text:\fdti\l\fArial\\i\\b\ Windows Error Reporting - Event ID 1000 - Application Error
COMMENT=color:%white%, font-face:Consolas, font-size:9, text:Event Time             Details
EVENTLOGEX=interval:60,logname:Application, maxrows:%maxrows%, font-face:Consolas, font-size:9, \
  xpath:*[System/EventID=1000], namespace:http://schemas.microsoft.com/win/2004/08/events/event, \
  display:%system_TimeCreated_local%[0.22s] %15[0.20s] %18[0.30s]

# system event logs
PAGE=15
PAGE-TITLE=System Event Logs
MENU=Event Logs
COLOR=%White%
WIDE=0

COMMENT=font-face:Arial,color:%White%,style:m, rich-text:1, font-size:11, text:\fdti\m\fArial\\i\\b\ System Event Logs
IF %dtimode% eq DESKTOP
EVENTLOG=interval:60,font-size:80%,log:System,maxrows:5,row-text:%1| ID: %2| Type: %3\, Task: %4, display:Source: %5|Computer: %6|%7|%8|%9|%10
IF %dtimode% eq WINDOW
EVENTLOG=interval:60,font-size:80%,log:System,maxrows:40,row-text:%1| ID: %2| Type: %3\, Task: %4, display:Source: %5|Computer: %6|%7|%8|%9|%10

IF %dtimode% eq DESKTOP
BUTTON=wide:1, align:r, color:%orange%,text:,display:Event Viewer,uri:eventvwr
IF %dtimode% eq WINDOW
BUTTON=xr:0, y:0, align:r, text:,display:Event Viewer,uri:eventvwr

PAGE=16
PAGE-TITLE=Application Event Logs
MENU=Event Logs

# application event logs
COMMENT=font-face:Arial,color:%White%,style:m, rich-text:1, font-size:11, text:\fdti\m\fArial\\i\\b\ Application Event Logs
IF %dtimode% eq DESKTOP
EVENTLOG=interval:6,font-size:80%,log:Application,maxrows:5, row-text:%1| ID: %2| Type: %3\, Task: %4, display:Source: %5|Computer: %6|%7|%8|%9|%10
IF %dtimode% eq WINDOW
EVENTLOG=interval:6,font-size:80%,log:Application,maxrows:40, row-text:%1| ID: %2| Type: %3\, Task: %4, display:Source: %5|Computer: %6|%7|%8|%9|%10

IF %dtimode% eq DESKTOP
BUTTON=wide:1, align:r, color:%orange%,text:,display:Event Viewer,uri:eventvwr
IF %dtimode% eq WINDOW
BUTTON=xr:0, y:0, align:r, text:,display:Event Viewer,uri:eventvwr

# installed software
PAGE=17
PAGE-TITLE=Software
MENU=Windows
COLOR=%Silver%
WIDE=1

COMMENT=font-face:Arial,color:%White%,style:m, rich-text:1, font-size:11, text:\fdti\n\fArial\\i\\b\ Installed Software - Windows Installer
CMD=font-face:Consolas,font-size:80%,trim:1,file:cmd.exe,parameters:/c wmic product get name\,version,thread:1, thread-timeout:30
COMMENT=font-face:Arial,color:%White%,style:m, rich-text:1, font-size:11, text:\fdti\n\fArial\\i\\b\ Installed Software - 32 bit
REG2=font-face:consolas,font-size:80%,thread:1,wow:32,subkeys:1,values:DisplayName\,DisplayVersion,key:HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall,display:%DisplayName%[0.56s] %DisplayVersion% 
COMMENT=font-face:Arial,color:%White%,style:m, rich-text:1, font-size:11, text:\fdti\n\fArial\\i\\b\ Installed Software - 64 bit
REG2=font-face:consolas,font-size:80%,thread:1,wow:64,subkeys:1,values:DisplayName\,DisplayVersion,key:HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall,display:%DisplayName%[0.56s] %DisplayVersion%

IF %dtimode% eq DESKTOP
BUTTON=align:r, color:%orange%, display:Control Panel, uri:control
IF %dtimode% eq WINDOW
BUTTON=xr:0, y:0, align:r, color:%white%, display:Control Panel, uri:control

# shared resources
PAGE=18
PAGE-TITLE=Shared Resources
MENU=Windows
COLOR=%Silver%
WIDE=0

# shared resources type lookup table
set share_type_0          = Disk Drive
set share_type_1          = Print Queue
set share_type_2          = Device
set share_type_3          = IPC
set share_type_2147483645 = IPC Admin
set share_type_2147483648 = Disk Drive Admin
set share_type_2147483649 = Print Queue Admin
set share_type_2147483650 = Device Admin
set share_type_2147483651 = IPC Admin

COMMENT=color:%White%,text:Shared Resources,style:imb
WMI=interval:60,text:Shared Resources, namespace:root\cimv2, query:Win32_Share,row-text:%Name%|  (%share_type_%Type%%),display:%Caption%|%path%|Status: %Status%

IF %dtimode% eq DESKTOP
BUTTON=wide:1 ,align:r, color:%orange%, display:Shared Resources, uri:fsmgmt.msc
IF %dtimode% eq WINDOW
BUTTON=xr:0, y:0, align:r, color:%white%, display:Shared Resources, uri:fsmgmt.msc

# netstats 1
PAGE=19
PAGE-TITLE=Net Stats - Connections
MENU=Network
COLOR=%Silver%
WIDE=1

# connection states
set netstate<null> = 
set netstate1 = closed
set netstate2 = listen
set netstate3 = syn_sent
set netstate4 = syn_rcvd
set netstate5 = estab
set netstate6 = fin_wait1
set netstate7 = fin_wait2
set netstate8 = close_wait
set netstate9 = closing
set netstate10 = last_ack
set netstate11 = time_wait
set netstate12 = delete_tcb

# TCP/UDP connections (traffic for tcp connections)
COMMENT=color:%White%,style:imb,text:Net Stats - Active Connections
COMMENT=style:bi,font-face:Consolas, font-size:8, text:image                pid  ipv  prot  local address        remote address       state    sent bytes   send b/sec    rcvd bytes    rcv b/sec
NETSTATS=interval:1,filter-state:3 4 5 6 7 8 9,stats:1, font-face:Consolas, font-size:8, \
  display:%module%[0.18s] %pid%[5.0f]  ipv%ipv%[0.4s]  %prot%  %laddrf%[0.20s] %raddrf%[0.20s] %netstate%state%%[0.8s] %databytesout%[9.0k]k    %databytesoutpersec%[9.0f]    %databytesin%[9.0k]k    %databytesinpersec%[9.0f]
		  
# netstats 2
PAGE=20
PAGE-TITLE=Net Stats - Listening
MENU=Network
COLOR=%Silver%
FONT-SIZE=8
WIDE=1

# TCP/UDP all listening connections		 
COMMENT=color:%White%,style:imb,text:Net Stats - Listening
COMMENT=style:ib,font-face:Consolas, font-size:8, text:image                pid  ipv   prot local addr           state
NETSTATS=interval:1,filter-state:2, font-face:Consolas, font-size:8, \
  display:%module%[0.18s] %pid%[5.0f]  ipv%ipv%  %prot%  %laddrf%[0.20s] %netstate%state%%

# security
PAGE=21
PAGE-TITLE=Security
MENU=Event Logs
COLOR=%Silver%
FONT-FACE=Consolas
FONT-SIZE=10
WIDE=1

COMMENT=font-face:Arial,color:%White%,style:m, rich-text:1, font-size:11, text:\fdti\o\fArial\\i\\b\ Security - Local User Logins
COMMENT=color:%white%, text:Boot Start Time          User Name            Domain Name
EVENTLOGEX=interval:60, logname:Security,  maxrows:10, \
  xpath: *[EventData[Data[@Name='LogonType']='2'] and System[(EventID='4624')]], \
  namespace:http://schemas.microsoft.com/win/2004/08/events/event, \
  alarms:(%BootTime% gt 90000 %red%) (%BootTime% gt 60000 %orange%), \
  display:%system_TimeCreated_local%[0.22s]   %TargetUserName%[0.18s]   %TargetDomainName%[0.18s]

COMMENT=font-face:Arial,color:%White%,style:m, rich-text:1, font-size:11, text:\fdti\o\fArial\\i\\b\ Security - Network User Logins
COMMENT=color:%white%, text:Boot Start Time          User Name            Domain Name
EVENTLOGEX=interval:60,logname:Security,  maxrows:10, \
  xpath: *[EventData[Data[@Name='LogonType']='3'] and System[(EventID='4624')]], \
  namespace:http://schemas.microsoft.com/win/2004/08/events/event, \
  alarms:(%BootTime% gt 90000 %red%) (%BootTime% gt 60000 %orange%), \
  display:%system_TimeCreated_local%[0.22s]   %TargetUserName%[0.18s]   %TargetDomainName%[0.18s]

COMMENT=font-face:Arial,color:%White%,style:m, rich-text:1, font-size:11, text:\fdti\o\fArial\\i\\b\ Security - Failed Local User Logins
COMMENT=color:%white%, text:Boot Start Time          User Name            Domain Name
EVENTLOGEX=interval:60, logname:Security,  maxrows:10, \
  xpath: *[EventData[Data[@Name='LogonType']='2'] and System[(EventID='4625')]], \
  namespace:http://schemas.microsoft.com/win/2004/08/events/event, \
  alarms:(%BootTime% gt 90000 %red%) (%BootTime% gt 60000 %orange%), \
  display:%system_TimeCreated_local%[0.22s]   %TargetUserName%[0.18s]   %TargetDomainName%[0.18s]

COMMENT=font-face:Arial,color:%White%,style:m, rich-text:1, font-size:11, text:\fdti\o\fArial\\i\\b\ Security - Failed Network User Logins
COMMENT=color:%white%, text:Boot Start Time          User Name            Domain Name
EVENTLOGEX=interval:60, logname:Security,  maxrows:10, \
  xpath: *[EventData[Data[@Name='LogonType']='3'] and System[(EventID='4625')]], \
  namespace:http://schemas.microsoft.com/win/2004/08/events/event, \
  alarms:(%BootTime% gt 90000 %red%) (%BootTime% gt 60000 %orange%), \
  display:%system_TimeCreated_local%[0.22s]   %TargetUserName%[0.18s]   %TargetDomainName%[0.18s]

# startup
PAGE=22
PAGE-TITLE=Startup Applications
MENU=Windows
FONT-FACE=Arial
COLOR=%silver%
WIDE=0

COMMENT=color:%White%,style:imb,text:Registry - Current User - Run
REG2=key:HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run, values-to-rows:1, row-text:%1, display:%2

COMMENT
COMMENT=color:%White%,style:imb,text:Registry - Current User - Run Once
REG2=key:HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce, values-to-rows:1, row-text:%1, display:%2

COMMENT
COMMENT=color:%White%,style:imb,text:Registry - Local Machine - Run
REG2=key:HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run, values-to-rows:1, row-text:%1, display:%2

COMMENT
COMMENT=color:%White%,style:imb,text:Registry - Local Machine - Run Once
REG2=key:HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce, values-to-rows:1, row-text:%1, display:%2

COMMENT
COMMENT=color:%White%,style:imb,text:Startup Folder - Current User
DIR=dir:C:\Users\Glenn\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup, row-text:%1, recurse:1, display:Size:%2[1.0b]B Version:%3 Create:%4 Write:%5 Access:%6

COMMENT
COMMENT=color:%White%,style:imb,text:Startup Folder - Public
DIR=dir:C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp, row-text:%1, recurse:1, display:Size:%2[1.0b]B Version:%3 Create:%4 Write:%5 Access:%6

BEGIN-ONLOAD
IF %dtimode% eq DESKTOP
BUTTON=wide:1 ,align:r, color:%orange%, display:Startup Programs, uri:taskmgr, args:/0 /startup
IF %dtimode% eq WINDOW
BUTTON=xr:0, y:0, align:r, color:%white%, display:Startup Programs, uri:taskmgr, args:/0 /startup
END-ONLOAD

# local area network
PAGE=23
PAGE-TITLE=Local Area Network
MENU=Network
FONT-FACE=Arial
COLOR=%cyan%
WIDE=1

COMMENT=font-face:Arial,color:%White%,style:m, rich-text:1, font-size:11, text:\fdti\d\fArial\\i\\b\ Local Area Network
LANHOSTS=font-face:Consolas, lan:10.0.0.34, resolve:1, thread:1, thread-timeout:360,\
  display:%host_ip%[0.17s] %host_name%[0.30s] %ping_time%[5.0f]ms  %ttl%[4.0f]

# tools
PAGE=24
PAGE-TITLE=Tools
COLOR=%lightgrey%
FONT-FACE=Arial
FONT-SIZE=10
WIDE=1

BOX=x:5,y:40,width:{{%width%-10}}, height:94, r:12, float:1
COMMENT=font-size:6
COMMENT=align:c, color:%White%,style:iub,text:Web Pages
BUTTON=hyperlink:1,align:c,color:%yellow%,display:Glenn's Page,uri:https://www.glenn.delahoy.com/desktopinfo
BUTTON=hyperlink:1,align:c,color:%yellow%,display:Google,uri:www.google.com
BUTTON=hyperlink:1,align:c,color:%yellow%,display:Cute Cat Pictures,uri:www.google.com/search?q=cat+pictures
COMMENT

# BUTTON2 will appear on the same display row as the most recent BUTTON item
BOX=x:5,y:160,width:{{%width%-10}}, height:290, r:12, float:1
COMMENT=align:c, text:|System Tools,style:iub,color:%white%
comment=font-size:2

# everything in this block is evaluated immediately after load and never again
BEGIN-ONLOAD
BUTTON =left:40, width:115,height:45,display:Device Manager,uri:devmgmt.msc
BUTTON2=left:165,width:115,height:45,display:Documents,uri:%userprofile%
BUTTON2=left:290,width:115,height:45,display:Control Panel,uri:control
BEGIN-IF=value1:%dtimode%, comp:eq, value2:WINDOW
 BUTTON2=left:415,width:115,height:45,display:Malware Removal Tool,uri:mrt
 BUTTON2=left:540,width:115,height:45,display:Memory Checker,uri:mdsched
 BUTTON2=left:665,width:115,height:45,display:Network Connections,uri:control.exe,args:ncpa.cpl
END-IF

BUTTON =left:40, width:115,height:45,display:Task Manager,uri:taskmgr
BUTTON2=left:165,width:115,height:45,display:Resource Monitor,uri:resmon
BUTTON2=left:290,width:115,height:45,display:System Info,uri:msinfo32.exe
BEGIN-IF=value1:%dtimode%, comp:eq, value2:WINDOW
 BUTTON2=left:415,width:115,height:45,display:Services,uri:services.msc
 BUTTON2=left:540,width:115,height:45,display:System Configuration,uri:msconfig
 BUTTON2=left:665,width:115,height:45,display:Devices and Printers,uri:control,args:printers
END-IF

BUTTON =left:40, width:115,height:45,display:Reliability Monitor,uri:%SystemRoot%\System32\perfmon.exe,args:/rel
BUTTON2=left:165,width:115,height:45,display:Print Management,uri:printmanagement.msc
BUTTON2=left:290,width:115,height:45,display:Command,uri:cmd.exe
BEGIN-IF=value1:%dtimode%, comp:eq, value2:WINDOW
 BUTTON2=left:415,width:115,height:45,display:Programs and Components,uri:control, args:appwiz.cpl
 BUTTON2=left:540,width:115,height:45,display:Disk Cleanup,uri:cleanmgr
 BUTTON2=left:665,width:115,height:45,display:Performance Monitor,uri:perfmon
END-IF

BUTTON =left:40, width:115,height:45,display:Windows Updates,uri:explorer.exe,args:ms-settings:windowsupdate
BUTTON2=left:165,width:115,height:45,display:User Accounts,uri:control, args:userpasswords2
BUTTON2=left:290,width:115,height:45,display:Windows Settings,uri:ms-settings:
BEGIN-IF=value1:%dtimode%, comp:eq, value2:WINDOW
 BUTTON2=left:415,width:115,height:45,display:System Properties,uri:control, args:sysdm.cpl
 BUTTON2=left:540,width:115,height:45,display:Windows Version,uri:winver
 BUTTON2=left:665,width:115,height:45,display:Event Viewer,uri:eventvwr
END-IF

BUTTON =left:40, width:115,height:45,display:Disk Management, uri:diskmgmt.msc
BUTTON2=left:165,width:115,height:45,display:Shared Resources, uri:fsmgmt.msc
BUTTON2=left:290,width:115,height:45,display:Bluetooth Settings, uri:%windir%\\explorer.exe, args:ms-settings:bluetooth

END-ONLOAD

COMMENT=style:b, font-size:12, x:30, text:||||        Scan for Support Desk
BUTTON=wide:1, xr:40, y:485, width:120, height:120, hyperlink:1, bgcolor:%silver%, align:r, text-align:c, column:1, \
  uri:https://www.glenn.delahoy.com, hint: Glenn's Support Desk, \
  barcode-symbol-type:qrcode, barcode-text:https://www.glenn.delahoy.com
BOX=x:5,y:475,width:{{%width%-10}}, height:140, r:12

comment

# chart demonstration
PAGE=25
PAGE-TITLE=Chart Demonstration
WIDE=0

begin-onload
set xx=0.1
set pie=0
end-onload

set xx={{%xx%+0.1}}
set sinx={{sin(%xx%)*100}}
set r1={{Rnd(100)}}
set r2={{Rnd(100)}}
set pie={{%pie%+1}}
IF %pie% gt 100
set pie=0

COMMENT=color:%plum%,font-face:Segoe Script, font-size:18, text:Chart Demonstration, style:imb, align:c
CHART=interval:3,text:Horizontal Bar,      style:b, chart:bar        height:2 series1:{{rnd(100)}} threshold:75 series2:{{rnd(100)}} threshold:60
comment
CHART=interval:3,text:%chart%,             style:b, chart:bar        height:2 series1:{{rnd(100)}} threshold:75 series2:{{rnd(100)}} threshold:60, display:Horizontal Bar in the left column,
comment
CHART=interval:1, wide:1,                  style:b, chart:line       height:3 border:0 points:90 series1:{{%r1%}} color1:00ff00, display:Line %chart%
comment
CHART=interval:3,text:Filled (inc neg values), style:b, chart:filled     height:3 border:0 points:40 series1:{{rnd(100)}} color1:00ff00 series2:{{rnd(50)}} color2:bb00bb series3:{{Neg(rnd(40))}} color3:#0000f0 width:140,align:c
comment
CHART=interval:4,text:VBar,                style:b, chart:vbar       height:3 border:0 points:10 series1:{{rnd(100)}} color1:00ff00 series2:{{rnd(100)}} color2:bb00bb series3:{{rnd(50)}} color3:#0000f0
comment
CHART=interval:1,text:Scatter (sine plot), style:b, chart:scatter    height:3 border:0 series1:{{%sinx%}} color1:00fff0
comment
CHART=interval:4,wide:1,text:3D,           style:b, chart:3d         height:3 border:0 points:10 series1:{{rnd(100)-50}} color1:00f090 series2:{{rnd(100)-50}} color2:bb00bb series3:{{Neg(rnd(40))}} color3:#0000f0
comment
CHART=interval:1,text-align:c, text:%chart%,             style:b, chart:pie        height:6 border:1 float:1 series1:%pie% series2:{{100-%pie%}} color2:#000000, display:||Pie (%pie%%)||||
comment
DATETIME=set:hr=%5 mn=%6 se=%7, hidden:1
CHART=display:%chart%, font-face:impact, font-size:18, align:c, text-align:r, text:|%hr%[2.0d] : %mn%[2.0d] : %se%[2.0d]||, \
  chart:vbarfilled points:1 height:3 width:200 max:60 border-color:%grey% float:1 \
  series1:%hr% color1:%lightblue% series2:%mn% color2:%purple% \
  series3:%se% color3:%orange%
comment
  
  
#
# sample scripts
# following sections are some sample scripts used by CMD items
# see the SET-SECTION and CMD items in the reference manual for details
# these used to be text files in a sub-directory called 'sample-scripts'
#


[windows-updates.ps1]
try {
  $msUpdateSession = New-Object -ComObject Microsoft.Update.Session
  $UpdateSearcher = $msUpdateSession.CreateUpdateSearcher()
  $SearchResult = $UpdateSearcher.Search('IsHidden=0 and IsInstalled=0')
  $totalUpdates = $($SearchResult.Updates.count)

  Write-Host "$totalUpdates"
}
catch {
  Write-Host '<error>'
  }

#
# Pending Windows Reboot
# SET-SECTION=key:pending-reboot,value:pending-reboot.ps1
# CMD=interval:3600,text:Reboot Pending,trim:1,file:powershell.exe,parameters:%pending-reboot%,code-page:437
#

[pending-reboot.ps1]
function Test-PendingReboot
{
    [CmdletBinding()]
    param
    (
        [Parameter(Position = 0, ValueFromPipeline = $true, ValueFromPipelineByPropertyName = $true)]
        [Alias('CN', 'Computer')]
        [String[]]
        $ComputerName = $env:COMPUTERNAME,

        [Parameter()]
        [System.Management.Automation.PSCredential]
        [System.Management.Automation.CredentialAttribute()]
        $Credential,

        [Parameter()]
        [Switch]
        $Detailed,

        [Parameter()]
        [Switch]
        $SkipConfigurationManagerClientCheck,

        [Parameter()]
        [Switch]
        $SkipPendingFileRenameOperationsCheck
    )

    process
    {
        foreach ($computer in $ComputerName)
        {
            try
            {
                $invokeWmiMethodParameters = @{
                    Namespace    = 'root/default'
                    Class        = 'StdRegProv'
                    Name         = 'EnumKey'
                    ComputerName = $computer
                    ErrorAction  = 'Stop'
                }

                $hklm = [UInt32] "0x80000002"

                if ($PSBoundParameters.ContainsKey('Credential'))
                {
                    $invokeWmiMethodParameters.Credential = $Credential
                }

                ## Query the Component Based Servicing Reg Key
                $invokeWmiMethodParameters.ArgumentList = @($hklm, 'SOFTWARE\Microsoft\Windows\CurrentVersion\Component Based Servicing\')
                $registryComponentBasedServicing = (Invoke-WmiMethod @invokeWmiMethodParameters).sNames -contains 'RebootPending'

                ## Query WUAU from the registry
                $invokeWmiMethodParameters.ArgumentList = @($hklm, 'SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update\')
                $registryWindowsUpdateAutoUpdate = (Invoke-WmiMethod @invokeWmiMethodParameters).sNames -contains 'RebootRequired'

                ## Query JoinDomain key from the registry - These keys are present if pending a reboot from a domain join operation
                $invokeWmiMethodParameters.ArgumentList = @($hklm, 'SYSTEM\CurrentControlSet\Services\Netlogon')
                $registryNetlogon = (Invoke-WmiMethod @invokeWmiMethodParameters).sNames
                $pendingDomainJoin = ($registryNetlogon -contains 'JoinDomain') -or ($registryNetlogon -contains 'AvoidSpnSet')

                ## Query ComputerName and ActiveComputerName from the registry and setting the MethodName to GetMultiStringValue
                $invokeWmiMethodParameters.Name = 'GetMultiStringValue'
                $invokeWmiMethodParameters.ArgumentList = @($hklm, 'SYSTEM\CurrentControlSet\Control\ComputerName\ActiveComputerName\', 'ComputerName')
                $registryActiveComputerName = Invoke-WmiMethod @invokeWmiMethodParameters

                $invokeWmiMethodParameters.ArgumentList = @($hklm, 'SYSTEM\CurrentControlSet\Control\ComputerName\ComputerName\', 'ComputerName')
                $registryComputerName = Invoke-WmiMethod @invokeWmiMethodParameters

                $pendingComputerRename = $registryActiveComputerName -ne $registryComputerName -or $pendingDomainJoin

                ## Query PendingFileRenameOperations from the registry
                if (-not $PSBoundParameters.ContainsKey('SkipPendingFileRenameOperationsCheck'))
                {
                    $invokeWmiMethodParameters.ArgumentList = @($hklm, 'SYSTEM\CurrentControlSet\Control\Session Manager\', 'PendingFileRenameOperations')
                    $registryPendingFileRenameOperations = (Invoke-WmiMethod @invokeWmiMethodParameters).sValue
                    $registryPendingFileRenameOperationsBool = [bool]$registryPendingFileRenameOperations
                }

                ## Query ClientSDK for pending reboot status, unless SkipConfigurationManagerClientCheck is present
                if (-not $PSBoundParameters.ContainsKey('SkipConfigurationManagerClientCheck'))
                {
                    $invokeWmiMethodParameters.NameSpace = 'ROOT\ccm\ClientSDK'
                    $invokeWmiMethodParameters.Class = 'CCM_ClientUtilities'
                    $invokeWmiMethodParameters.Name = 'DetermineifRebootPending'
                    $invokeWmiMethodParameters.Remove('ArgumentList')

                    try
                    {
                        $sccmClientSDK = Invoke-WmiMethod @invokeWmiMethodParameters
                        $systemCenterConfigManager = $sccmClientSDK.ReturnValue -eq 0 -and ($sccmClientSDK.IsHardRebootPending -or $sccmClientSDK.RebootPending)
                    }
                    catch
                    {
                        $systemCenterConfigManager = $null
                        Write-Verbose -Message ($script:localizedData.invokeWmiClientSDKError -f $computer)
                    }
                }

                $isRebootPending = $registryComponentBasedServicing -or `
                    $pendingComputerRename -or `
                    $pendingDomainJoin -or `
                    $registryPendingFileRenameOperationsBool -or `
                    $systemCenterConfigManager -or `
                    $registryWindowsUpdateAutoUpdate

                if ($PSBoundParameters.ContainsKey('Detailed'))
                {
                    [PSCustomObject]@{
                        ComputerName                     = $computer
                        ComponentBasedServicing          = $registryComponentBasedServicing
                        PendingComputerRenameDomainJoin  = $pendingComputerRename
                        PendingFileRenameOperations      = $registryPendingFileRenameOperationsBool
                        PendingFileRenameOperationsValue = $registryPendingFileRenameOperations
                        SystemCenterConfigManager        = $systemCenterConfigManager
                        WindowsUpdateAutoUpdate          = $registryWindowsUpdateAutoUpdate
                        IsRebootPending                  = $isRebootPending
                    }
                }
                else
                {
                    [PSCustomObject]@{
                        ComputerName    = $computer
                        IsRebootPending = $isRebootPending
                    }
                }
            }

            catch
            {
                Write-Verbose '$Computer`: $_'
            }
        }
    }
}

# Test-PendingReboot
if ((Test-PendingReboot).IsRebootPending) {
Write-Host "Reboot Pending"
} else {
Write-Host "No Reboot Pending"
}



[bitlocker-status.ps1]
## Get BitLocker drive status for DesktopInfo
## Does NOT require Admin rights
##
## To work properly, PowerShell Execution Policy must be set to RemoteSigned.
##
## Get arguments for Local or Removable
## Valid parameters are 'Local Fixed' or 'Removable'
$query = '%bitlocker-query%'
If ( -not $query ) { Exit 1 }

## set status values
$blStatusDesc = @(
				[pscustomobject]@{desc='Status Unknown'}
				[pscustomobject]@{desc='Fully Encrypted'}
				[pscustomobject]@{desc='Unencrypted'}
				[pscustomobject]@{desc='Encryption in Progress'}
				[pscustomobject]@{desc='Decryption in Progress'}
				[pscustomobject]@{desc='Encryption Suspended'}
				[pscustomobject]@{desc='Decryption Suspended'}
				)

## Output headers
Write-Host ('Name ')('Size').PadLeft(16)('Free Space').PadLeft(16)BitLocker

## get local volumes using WMI
ForEach ( $logicalVol in (Get-CimInstance -Class Win32_LogicalDisk | Where-Object Description -like "$query*") ) {
	$blStatus=(New-Object -ComObject Shell.Application).NameSpace($($logicalVol.Name)).Self.ExtendedProperty('System.Volume.BitLockerProtection')
	Write-Host $logicalVol.Name.ToString().PadRight(5),($logicalVol.Size /1000000000).ToString('N0').PadLeft(13)MB,($logicalVol.FreeSpace/1000000000).ToString('N0').PadLeft(13)MB, $blStatusDesc[$blStatus].desc
}

[wifi-status.ps1]
$wifi_status = @( netsh wlan show interfaces ).Replace(' : ',' = ')
$wifi_status = $wifi_status.Split('=').Trim()

If ( -not $wifi_status.Contains('connected') ) { Exit 0 }

$State = $wifi_status[ [Array]::indexOf($wifi_status,'State') + 1 ]
$SSID = $wifi_status[ [Array]::indexOf($wifi_status,'SSID') + 1 ]
$BSSID = $wifi_status[ [Array]::indexOf($wifi_status,'BSSID') + 1 ]
$NetType = $wifi_status[ [Array]::indexOf($wifi_status,'Network type') + 1 ]
$Radio = $wifi_status[ [Array]::indexOf($wifi_status,'Radio type') + 1 ]
$Auth = $wifi_status[ [Array]::indexOf($wifi_status,'Authentication') + 1 ]
$Cipher = $wifi_status[ [Array]::indexOf($wifi_status,'Cipher') + 1 ]
$Band = $wifi_status[ [Array]::indexOf($wifi_status,'Band') + 1 ]
$Channel = $wifi_status[ [Array]::indexOf($wifi_status,'Channel') + 1 ]
$Signal = $wifi_status[ [Array]::indexOf($wifi_status,'Signal') + 1 ]

# Output headers and data
Write-Host State ',' SSID ',' BSSID ',' NetType ',' Radio ',' Auth ',' Cipher ',' Band ',' Channel ',' Signal
Write-Host $State ',' $SSID ',' $BSSID ',' $NetType ',' $Radio ',' $Auth ',' $Cipher ',' $Band ',' $Channel ',' $Signal
